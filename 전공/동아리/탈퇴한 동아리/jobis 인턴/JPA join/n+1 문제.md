___



### ==1. n+1 문제란?==
ORM 기술에서 특정 쿼리가 해당 객체가 가지고 있는 [[연관관계]] 또한 조회하게 되면서 N번의 추가적인 쿼리가 발생하는 문제.


##### 발생하는 원인
: 관계형 데이터베이스와 객체지향 언어간의 패러다임 차이로 인해 발생함. 객체는 연관관계를 통해 레퍼런스를  가지고 있으면 언제든디 메모리 내에서 [[랜덤 엑세스]] 를 통해 연관 객체에 접근 수 있지만 RDB의 경우 Select 쿼리를 통해서만 조회할수 있기 때문이다.


##### 문제가 되는 까닭
n+1 문제가 발생시 쿼리가 배수적으로 증가 -> DB에 큰 부담이 발생하고 , 장애 요인이 될수 있다. 또한 사용자 관점에서 보면, 지연율이 크게 증가할수 있다.


### Eager Loadin 으로 n+1문제를 해결하려고 하면 안된다
 
### 이유
*  어떤 Entity 연관관계 범위까지 join 쿼리로 조회해올지 예상하기 힘듬 -> 필요없는 데이터까지 로딩하여 비효율적
* Entity관계가 복잡해지면 N+1 문제가 해결 되지 않는 경우가 많다.

### 해결방법

### Fetch Join + [[Lazy Loading]]
Fetch Join은 Root Entity에 대해서 조회 할 때 Lazy Loading 으로 설정되어 있는 연관관계join 쿼리를 발생시켜 한번에 조회할 수 있도록 하는 기능.
// 직접 참조할때 가지고 옴.

eager : 한번에 연관된 것들을 한번에 가지고 옴. 

쿼리 dsl 프레임워크 : 직접 가지고오고싶은 데이터 추출.




